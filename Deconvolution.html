<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Image Analysis with Fiji</title>
<link rel="stylesheet" href="css/reveal.css">
<link rel="stylesheet" href="css/theme/cci.css">
<link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
<!-- Theme used for syntax highlighting of code -->
<link rel="stylesheet" href="lib/css/zenburn.css">
<!-- Printing and PDF exports -->
<script>
var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
document.getElementsByTagName( 'head' )[0].appendChild( link );
</script>
</head>
<body>
<div class="reveal">
<!-- Header logo -->
<!--img style="position:fixed;top:1em;right:1em;" src="img/logo_cci.png" width="15%"-->
<!-- Slide Title -->
<header style="position: absolute;top: 1em; left: 1em; z-index:10;"></header>



<!-- ---------------------- START OF SLIDES -------------------------- -->


<div class="slides">

<section data-menu-title="Title">
<h1>Deconvolution</h1>
<h3>Laura Cooper<br>Research Fellow, CAMDU</h3>
<br>
<p>Navigation:
<ul><li> Left/right arrow keys for previous/next slide</li><li>'m' key to get to navigation menu</li><li>Escape for slide overview</li></ul>
</p>
</section>

<section data-menu-title="Acknowledgements" data-state="intro0a">
	<h1>Acknowledgements</h1>
	<p>Slides adpated from presentations by:
	<ul>
	<li>Dave Mason, formerly University of Liverpool: <a target="_blank" href="https://pcwww.liv.ac.uk/~dnmason/ia.html">https://pcwww.liv.ac.uk/~dnmason/ia.html</a></li>
	<li>Erick Martins Ratamero, formerly University of Warwick</li>
	<li>Lewis Mosby, University of Warwick</li>
	<li>Philo van Kemenade (<a href="twitter.com/phivk">@phivk</a>)</li>
        <li>Some material also from <a href="https://imagej.net/Introduction_into_Macro_Programming">ImageJ website</a></li>
        </ul>
	</p>
</section>

<section data-menu-title="Deconvolution" data-state="decon">
<h1>Recap</h1>
<ul class="left half">
<li>When aquiring an image, we detect the point spread function (PSF). It blurs every point in the image</li>
<li>Fourier transforms can be used speed up convolution. Convolution in the spatial domain is the same as multiplication in the frequency domain</li>
<li class="fragment">Image formation in the microscope can be understood as convolution between the object being imaged and the PSF of the imaging system</li>
</ul>
<img class="fragment right third" src="img-lc/PSF.png"/>
</section>

<section data-state="decon">
<h1>Approximating the PSF</h1>
<ul class="left half">
<li>PSF are approximated by imaging very small beads. If the beads are smaller than the resolution, the outputs will be the PSF.</li>
<li>Theoretical PSF are sometimes used, often approximated as a Gaussian function.</li>
<li>If we have the PSF and the image can we reconstruct the object?</li>
</ul>
<img class="right third" src="img-lc/PSF.png"/>
</section>

<section data-state="decon">
<h1>Deconvolution</h1>
<ul class="left half">
<li>In the spatial domain, let an image, I, be an object, O, convolved with a PSF, P. i.e. I=O*P</li>
<li>Then, in the frequency domain, we have the F(I)=F(O) x F(P), where F represent the Fourier transform</li>
<li>So F(O)=F(I) &divide F(P)</li>
<li>By taking the inverse Fourier transform of F(O), we obtain O, the object.</li>
<li>This is known as <b>naive deconvolution</b></li>
</ul>
<img class="right third" src="img-lc/PSF.png"/>
</section>

<section data-state="decon">
<h1>Deconvolution Issues</h1>
<ul>
<li>Extremely sensitive to noise</li>
<li>Can have artifacts if the light source is not constant</li>
<li>More advanced methods are very computationally intesive</li>
</ul>
</section>

<section data-state="fiji2"><style>.fiji2 header:after { content: "Fiji Basics"; }</style>
<h1>Useful FIJI tips</h1>
<ul class="left half">
<li>Zoom using +/- keys</li>
<li>When zoomed in, pan by holding space and click-dragging with mouse</li>
<li>Hit 'Enter' to bring the Fiji window to the front</li>
<li>Find:
<ul><li>infobar (top left of image): gives info on the image</li>
<li>statusbar (bottom left of toolbar): gives current cursor coordinates and intensity readout</li>
</ul>
</ul>
<img  class="right third" src="img-ia/fiji8.png"/>
</section>

<section data-state="fiji2"><style>.fiji2 header:after { content: "Fiji Basics"; }</style>
<h1>ImageJ Macro Recap</h1>
<h2>What does this code do?</h2>
<pre><code class="C">for(i = 0; i < nSlices; i++){
    print(i);
}
</code></pre>
<code>nSlices</code> and <code>print</code> are <a href=https://imagej.nih.gov/ij/developer/macro/functions.html>built in functions</a>
</section>

<section data-state="fiji2"><style>.fiji2 header:after { content: "Fiji Basics"; }</style>
<h1>Improved solution</h1>
<pre><code class="C">
// Open input window to enter input file
#@ File (label = "Input directory", style = "file") input
open(input);
// Or: open('/Downloads/test/example1.tif');

// Count number of slices in image
for(i = 1; i <= nSlices; i++){
    print("Slice: " + i);
}
print("Image contains: " + nSlices + " slices");
</code></pre>
<code>#@</code> indicates a <a href=https://imagej.net/Script_parameters>script paramter</a>
    </section>



<section data-menu-title="More things to try">
<div>
<h1>More things to try:</h1>
<ul>
<li>Crop an image </li>
<li>Rename an image</li>
<li>Scale an image</li>
<li>Invert an image </li>
<li>Using a colour image, separate the colours into separate images</li>
<li>Using a 3D image, apply a Z-projection</li>
<li>Duplicate an image, apply a filter to one of the copies, use the <code>Image Calculator</code> to subtract the filtered image from the original</li>
</ul>
<p><b>Before you start remember: <code>[Plugins > Macros > Record]</code></b></p>
</section>
</div>

</div> <!-- ---------------------- END OF SLIDES -------------------------- -->

<!-- Footer -->
<img style="position:fixed;bottom:1em;right:1em;" src="img/logo_WMS.jpg" width="10%">
<!--img style="position:fixed;bottom:1em;left:1em;" src="img/logo_tw.png" width="20%"-->
</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>
// More info about config & dependencies:
// - https://github.com/hakimel/reveal.js#configuration
// - https://github.com/hakimel/reveal.js#dependencies
Reveal.initialize({
    controls: false,
	slideNumber: true, //-- Added for development
dependencies: [
{ src: 'plugin/markdown/marked.js' },
{ src: 'plugin/markdown/markdown.js' },
{ src: 'plugin/notes/notes.js', async: true },
{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
{ src: 'plugin/menu/menu.js' }
],
menu: {
hideMissingTitles: true,
themes: false,
transitions: false,
//markers: true,
numbers: true,
openButton: false,
titleSelector: 'span.menu-title'

}
});
</script>
</body>
</html>
